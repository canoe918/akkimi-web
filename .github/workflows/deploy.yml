name: git push into personal lazydoer repo to deploy to vercel

on:
  push:
    branches: ["main", "develop"]
  pull_request:
    branches: ["main", "develop"]

  # Allows you to run this workflow manually from the Actions tab
  workflow_dispatch:

jobs:
  # This workflow contains a single job called "build"
  build:
    runs-on: ubuntu-latest

    # Steps represent a sequence of tasks that will be executed as part of the job
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: echo
        run: |
          echo "$GITHUB_ENV"

      - name: Verify secrets
        run: |
          if [ -z "$EMAIL_ACCOUNT" ]; then
            echo "Error: EMAIL_ACCOUNT is not set or is empty"
            exit 1
          else
            echo "EMAIL_ACCOUNT is set"
          fi

          echo "EMAIL_ACCOUNT=$EMAIL_ACCOUNT" >> $GITHUB_ENV

      - name: Use secret
        run: echo "Using EMAIL_ACCOUNT=$EMAIL_ACCOUNT"
        env:
          EMAIL_ACCOUNT: ${{ env.EMAIL_ACCOUNT }}

      # - name: Run mirror current repository
      #   run: sh ./build.sh

      # - name: Pushes to lazydoer repository
      #   id: push_directory
      #   uses: cpina/github-action-push-to-another-repository@main
      #   env:
      #     API_TOKEN_GITHUB: ${{ secrets.REPOSITORY_TOKEN }}
      #   with:
      #     source-directory: "output"
      #     destination-github-username: "canoe918"
      #     destination-repository-name: "akkimi-web"
      #     user-email: ${{ secrets.EMAIL_ACCOUNT }}
      #     commit-message: ${{ github.event.commits[0].message }}
      #     target-branch: main

      # - name: Test get variable exported by push-to-another-repository
      #   run: echo $DESTINATION_CLONED_DIRECTORY
